---
sidebar_position: 10
---

# 開発要件

## デバッグログ
ブラウザ上のデバッグログをサーバ側にアップロードできること

### 背景
SPA はクライアント側で動作するので、ユーザが利用中に想定外のエラーが発生した場合にブラウザのコンソールを見ることができないので、デバッグが難しいです。

### 詳細
* デバッグログをブラウザの local storage に蓄積し、 critical な例外が発生した際ににサーバにアップロードすること
* 蓄積しているデバッグログをユーザ操作により、ブラウザ上で表示したり、サーバにアップロードすることができること
* デバッグログは上限サイズ(100Kくらい？）をこえたところでローテートし、一定量（3個くらい）以上はたまらないようにすること

## devDependency
本番稼働環境にデプロイする場合に package.json の devDependency のモジュールが node_modules にインストールされないようにすること。

* yarn publish だと入らない?（未検証）
* コンテナ内に git clone して npm ci するとかだと入ってしまうので、 --production とか --omit=dev などをつけてインストールを避けること

## テスト自動化
テストを自動化すること。

* モジュール内単体テストは jest でテストすること
* REST API レベルのテストは jest-rest でテストすること
* Gadget のテストは Playwright などのヘッドレスブラウザで実行すること

## TDD
テスト駆動型開発を実施すること。すべての開発は以下の手順で実施する。

1. テストプログラムを書く
1. テストを実行してテストが失敗することを確認する
1. コーディングしてテストが成功するまでデバッグする

ただし、Playwright によるテスト自動化は修正に対するコストが高いため、テストプログラムの代わりにテスト手順書を書くこととする。
* テスト手順書をマニュアルの操作例とすることが推奨される。
* Playwright によるテスト自動化は仕様が Fix してから、別作業として実施する。

## 文書の自動化
できるだけ、ドキュメントをソースコードから生成すること

### 詳細
REST API については、 swagger.yml を生成すること。 example をふんだんに含めること。
APIをライブラリ提供する場合は TSDoc でソースコード中のコメントからドキュメントを生成すること。

## node v18 と yarn を利用
node v18 と yarn を利用すること。 package.json に以下の記述を追加すること。

```javascript
  "engines": {
    "node": ">=18",
    "npm": "please_use_yarn_instead"
  },
```